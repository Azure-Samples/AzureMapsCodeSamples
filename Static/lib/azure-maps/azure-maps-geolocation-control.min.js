/* MIT License - Copyright (c) Microsoft Corporation. */


!function(e,d){"use strict";var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t])})(e,o)};var r=function(){return(r=Object.assign||function(e){for(var o,t=1,a=arguments.length;t<a;t++)for(var n in o=arguments[t])Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);return e}).apply(this,arguments)};function o(e,r,s,l){return new(s=s||Promise)(function(t,o){function a(e){try{i(l.next(e))}catch(e){o(e)}}function n(e){try{i(l.throw(e))}catch(e){o(e)}}function i(e){var o;e.done?t(e.value):((o=e.value)instanceof s?o:new s(function(e){e(o)})).then(a,n)}i((l=l.apply(e,r||[])).next())})}function a(t,a){var n,i,r,e,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return e={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function o(o){return function(e){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=0<(r=s.trys).length&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=a.call(t,s)}catch(e){o=[6,e],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,e])}}}var n=(i.merge=function(e,o){for(var t=window||global,a=0,n=e.split(".");a<n.length;a++){var i=n[a];if(!t[i])return o;t=t[i]}return r(r({},t),o)},i);function i(){}var s,l,c,p=(s=d.internal.EventEmitter,t(l=g,c=s),l.prototype=null===c?Object.create(c):(u.prototype=c.prototype,new u),g.prototype.dispose=function(){var o=this;o._map&&o._map.controls.remove(o),Object.keys(o).forEach(function(e){o[e]=null})},g.prototype.getLastKnownPosition=function(){return JSON.parse(JSON.stringify(this._lastKnownPosition))},g.prototype.onAdd=function(e,o){var t=this,a=(t._map=e).getMapContainer().classList;a.contains("high-contrast-dark")?t._hclStyle="dark":a.contains("high-contrast-light")&&(t._hclStyle="light"),t._resource=t._getTranslations(t._map.getStyle().language);var n=g,i=n._iconTemplate.replace("{color}","Gray"),r=n._iconTemplate.replace("{color}","DeepSkyBlue"),s=n._gpsBtnCss.replace(/{grayIcon}/g,i).replace(/{blueIcon}/g,r),l=document.createElement("style");l.innerHTML=s,document.body.appendChild(l);var c=document.createElement("div");c.classList.add("azure-maps-control-container"),c.setAttribute("aria-label",t._resource[0]),c.style.flexDirection="column",c.style.display="none",t._container=c;var p=document.createElement("button");return p.classList.add("azmaps-gpsBtn"),p.classList.add("azmaps-gpsDisabled"),p.setAttribute("title",t._resource[0]),p.setAttribute("alt",t._resource[0]),p.setAttribute("type","button"),p.addEventListener("click",t._toggleBtn),t._button=p,t._updateState(),t.setOptions(t._options),c.appendChild(p),n.isSupported().then(function(e){e?t._container.style.display="":t._invokeEvent("geolocationerror",{code:2,message:"Geolocation API not supported by device.",PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2,TIMEOUT:3})}),t._map.events.add("movestart",t._mapMoveStarted),t._map.events.add("moveend",t._mapMoveEnded),t.setOptions(t._options),addEventListener("beforeunload",t._pageUnload,!1),c},g.prototype.onRemove=function(){var e=this;e._container&&e._container.remove(),"auto"===e._options.style&&e._map.events.remove("styledata",e._mapStyleChanged),e._map.events.remove("movestart",e._mapMoveStarted),e._map.events.remove("moveend",e._mapMoveEnded),void 0!==e._watchId&&navigator.geolocation.clearWatch(e._watchId),e._gpsMarker&&e._map.markers.remove(e._gpsMarker),e._map=null,removeEventListener("beforeunload",e._pageUnload)},g.prototype.getOptions=function(){return Object.assign({},this._options)},g.prototype.setOptions=function(e){var o=this,t=o._options;if(e){var a="white";if(o._hclStyle)"dark"===o._hclStyle&&(a=o._darkColor);else switch("auto"===t.style&&o._map.events.remove("styledata",o._mapStyleChanged),t.style=e.style,e.style){case"dark":a=o._darkColor;break;case"auto":o._map.events.add("styledata",o._mapStyleChanged),a=o._getColorFromMapStyle()}if(o._button.style.backgroundColor=a,e.markerColor&&(t.markerColor=e.markerColor,o._gpsMarker&&(o._gpsMarker.getOptions().htmlContent.querySelector(".gps-dot").style.backgroundColor=e.markerColor)),"number"==typeof e.maxZoom&&(t.maxZoom=Math.min(Math.max(e.maxZoom,0),24)),"boolean"==typeof e.calculateMissingValues&&(t.calculateMissingValues=e.calculateMissingValues),"boolean"==typeof e.updateMapCamera&&(t.updateMapCamera=e.updateMapCamera,o._updateMapCamera=e.updateMapCamera),"boolean"==typeof e.showUserLocation&&(t.showUserLocation=e.showUserLocation,o._gpsMarker?o._gpsMarker.setOptions({visible:o._isActive&&e.showUserLocation}):o._lastKnownPosition&&o._onGpsSuccess()),"boolean"==typeof e.trackUserLocation&&(t.trackUserLocation=e.trackUserLocation),e.positionOptions){var n={};e.positionOptions.enableHighAccuracy&&(n.enableHighAccuracy=e.positionOptions.enableHighAccuracy),"number"==typeof e.positionOptions.maximumAge&&(n.maximumAge=e.positionOptions.maximumAge),"number"==typeof e.positionOptions.timeout&&(n.timeout=e.positionOptions.timeout),0<Object.keys(n).length&&(t.positionOptions=Object.assign(t.positionOptions,n),o._stopTracking(),o._updateState())}}},g.prototype.toggle=function(e){var o=this;o._isActive="boolean"==typeof e?e:!o._isActive,o._isActive&&o._options.trackUserLocation&&o._lastKnownPosition&&o._onGpsSuccess(),o._updateMapCamera=o._options.updateMapCamera,o._updateState()},g.isSupported=function(){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return window.navigator.permissions?[4,window.navigator.permissions.query({name:"geolocation"})]:[3,2];case 1:return[2,"denied"!==e.sent().state];case 2:return[2,!!window.navigator.geolocation]}})})},g.prototype._getColorFromMapStyle=function(){return-1<["satellite","satellite_road_labels","grayscale_dark","night"].indexOf(this._map.getStyle().style)?this._darkColor:"white"},g.prototype._stopTracking=function(){"number"==typeof this._watchId&&(navigator.geolocation.clearWatch(this._watchId),this._watchId=null)},g.prototype._updateState=function(){var e=this;e._isActive&&!e._options.trackUserLocation||e._stopTracking(),e._gpsMarker&&e._gpsMarker.setOptions({visible:e._isActive&&e._options.showUserLocation});var o=e._resource[2],t="azmaps-gpsEnabled",a="azmaps-gpsDisabled";e._isActive?(t="azmaps-gpsDisabled",a="azmaps-gpsEnabled",e._options.trackUserLocation?("number"!=typeof e._watchId&&(e._watchId=navigator.geolocation.watchPosition(e._onGpsSuccess,function(){navigator.geolocation.getCurrentPosition(e._onGpsSuccess,e._onGpsError,Object.assign({},e._options.positionOptions,{enableHighAccuracy:!1}))},Object.assign({},e._options.positionOptions,{enableHighAccuracy:!0}))),o=e._resource[1]):navigator.geolocation.getCurrentPosition(e._onGpsSuccess,function(){navigator.geolocation.getCurrentPosition(e._onGpsSuccess,e._onGpsError,Object.assign({},e._options.positionOptions,{enableHighAccuracy:!1}))},Object.assign({},e._options.positionOptions,{enableHighAccuracy:!0}))):e._options.trackUserLocation&&(o=e._resource[0]);var n=e._button;n.setAttribute("title",o),n.setAttribute("alt",o),n.classList.remove(t),n.classList.add(a)},g.prototype._getMarkerIcon=function(){var e=document.createElement("div");return e.className="gps-container",e.innerHTML=g._gpsDotIcon.replace("{color}","dodgerBlue"),e},g.prototype._updateMarkerHeading=function(){var e=this._lastKnownPosition.properties.heading,o="none",t=!0;isNaN(e)||(e=Math.round(e),this._gpsMarker.marker.setRotation(e),t=!(o="polygon(50% 50%, 0% 0%, 100% 0%)"));var a=this._gpsMarker.getOptions().htmlContent.querySelector(".gps-pulse");a.style.clipPath=o;var n="gps-pulse-animation",i=a.classList,r=i.contains(n);t?r||i.add(n):r&&i.remove(n)},g.prototype._getTranslations=function(e){e&&0<e.indexOf("-")&&(e=e.substring(0,e.indexOf("-")));var o=g._translations,t=o[e];return t=t||o.en},g._gpsDotIcon='<div class="gps-dot" style="background-color:{color}"></div><div class="gps-wedge"><div class="gps-pulse"></div></div>',g._iconTemplate="data:image/svg+xml;utf8,<svg version='1.1' xmlns='http://www.w3.org/2000/svg' x='0' y='0' viewBox='0 0 561 561' xml:space='preserve'><g fill='{color}'><path d='M280.5,178.5c-56.1,0-102,45.9-102,102c0,56.1,45.9,102,102,102c56.1,0,102-45.9,102-102C382.5,224.4,336.6,178.5,280.5,178.5z M507.45,255C494.7,147.9,410.55,63.75,306,53.55V0h-51v53.55C147.9,63.75,63.75,147.9,53.55,255H0v51h53.55C66.3,413.1,150.45,497.25,255,507.45V561h51v-53.55C413.1,494.7,497.25,410.55,507.45,306H561v-51H507.45z M280.5,459C181.05,459,102,379.95,102,280.5S181.05,102,280.5,102S459,181.05,459,280.5S379.95,459,280.5,459z'/></g></svg>",g._gpsBtnCss='.azmaps-gpsBtn{margin:0;padding:0;border:none;border-collapse:collapse;width:32px;height:32px;text-align:center;cursor:pointer;line-height:32px;background-repeat:no-repeat;background-size:20px;background-position:center center;z-index:200;box-shadow:0px 0px 4px rgba(0,0,0,0.16);}.azmaps-gpsDisabled{background-image:url("{grayIcon}");}.azmaps-gpsDisabled:hover{background-image:url("{blueIcon}");filter:brightness(90%);}.azmaps-gpsEnabled{background-image:url("{blueIcon}");}.azmaps-gpsEnabled:hover{background-image:url("{blueIcon}");filter:brightness(90%);}.gps-container{position:relative;width:16px;height:16px;}.gps-dot{width:12px;height:12px;background-color:dodgerBlue;border:2px white solid;border-radius:50%;position:absolute;top:50%;left:50%;transform: translate(-50%, -50%);z-index:100000;}.gps-wedge{width:16px;height:16px;position:absolute;top:0;left:0;z-index:99999;}.gps-pulse{width:100%;height:100%;border-radius:50%;background-image: radial-gradient(rgba(30,144,255,1),rgba(30,144,255,0.5));position:absolute;transform-origin:center;transform:scale(2.5);}.gps-pulse-animation{animation:gps-pulse-animation-key 2s infinite ease-out;}@keyframes gps-pulse-animation-key { 0% {transform:scale(0.5);opacity:1;} 100% {transform: scale(2.5);opacity:0.5;}}',g._translations={af:["begin dop","stop die dop","my plek","ligginggewing beheer"],ar:["بدء تتبع","تتبع توقف","موقعي","السيطرة تحديد الموقع الجغرافي"],eu:["Hasi segimendua","Stop jarraipena","Nire kokapena","Geokokapen kontrol"],bg:["Започнете да проследявате","Спиране на проследяването","Моето място","контрол за геолокация"],zh:["开始跟踪","停止追踪","我的位置","地理位置控制"],hr:["Započnite praćenje","zaustavljanje praćenje","Moja lokacija","kontrola Geolocation"],cs:["začít sledovat","Zastavit sledování","Moje lokace","ovládání Geolocation"],da:["Start sporing","Stop sporing","min placering","Geolocation kontrol"],nl:["beginnen met het bijhouden","stop volgen","Mijn locatie","Geolocation controle"],et:["Alusta jälgimist","Stopp jälgimise","Minu asukoht","Geolocation kontrolli"],fi:["Aloita seuranta","Lopeta seuranta","Minun sijaintini","Geolocation ohjaus"],fr:["Démarrer le suivi","suivi d'arrêt","Ma position","le contrôle de géolocalisation"],gl:["comezar a controlar","seguimento parada","A miña localización","control de xeolocalización"],de:["starten Sie Tracking","Stop-Tracking","Mein Standort","Geolokalisierung Steuer"],el:["Ξεκινήστε την παρακολούθηση","Διακοπή παρακολούθησης","Η τοποθεσία μου","ελέγχου geolocation"],hi:["ट्रैक करना शुरू","बंद करो ट्रैकिंग","मेरा स्थान","जियोलोकेशन नियंत्रण"],hu:["követés indítása","követés leállítása","Saját hely","Geolocation ellenőrzés"],id:["Mulai pelacakan","berhenti pelacakan","Lokasi saya","kontrol geolocation"],it:["Inizia il monitoraggio","monitoraggio arresto","La mia posizione","controllo geolocalizzazione"],ja:["追跡を開始","追跡を停止","私の場所","ジオロケーション制御"],kk:["қадағалау бастау","қадағалау тоқтату","Менің орналасуы","геоорын бақылау"],ko:["추적 시작","정지 추적","내 위치","위치 정보 제어"],es:["iniciar el seguimiento","Detener el seguimiento","Mi ubicacion","control de geolocalización"],lv:["Sākt izsekošana","Stop izsekošana","Mana atrašanās vieta","Geolocation kontrole"],lt:["pradėti stebėti","Sustabdyti sekimo","Mano vieta","Geografinė padėtis kontrolė"],ms:["mula menjejaki","Stop pengesanan","Lokasi saya","kawalan geolokasi"],nb:["begynne å spore","stopp sporing","Min posisjon","geolocation kontroll"],pl:["rozpocząć śledzenie","Zatrzymaj śledzenie","Moja lokacja","kontrola Geolokalizacja"],pt:["começar a controlar","rastreamento parada","Minha localização","controle de geolocalização"],ro:["Pornire urmărire","Oprire urmărire","Locatia mea","controlul de geolocalizare"],ru:["Начать отслеживание","остановка отслеживания","Мое местонахождение","контроль геолокации"],sr:["Старт трацкинг","стоп праћење","Моја локација","kontrola геолоцатион"],sk:["začať sledovať","zastaviť sledovanie","moja poloha","ovládanie Geolocation"],sl:["Začni sledenje","Stop za sledenje","moja lokacija","nadzor Geolocation"],sv:["börja spåra","Stoppa spårning","Min plats","geolocation kontroll"],th:["เริ่มการติดตาม","ติดตามหยุด","ตำแหน่งของฉัน","ควบคุม Geolocation"],tr:["izlemeyi başlat","Dur izleme","Benim konumum","Coğrafi Konum kontrolü"],uk:["почати відстеження","зупинка відстеження","моє місце розташування","контроль геолокації"],vi:["Bắt đầu theo dõi","dừng theo dõi","vị trí của tôi","kiểm soát định vị"],en:["Start tracking","Stop tracking","My location","Geolocation control"]},g);function u(){this.constructor=l}function g(e){var g=s.call(this)||this;if(g._options={style:"light",positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},showUserLocation:!0,trackUserLocation:!1,markerColor:"DodgerBlue",maxZoom:15,calculateMissingValues:!1,updateMapCamera:!0},g._darkColor="#011c2c",g._hclStyle=null,g._isActive=!1,g._updateMapCamera=!0,g._pageUnload=function(){g._stopTracking()},g._toggleBtn=function(){g.toggle()},g._mapStyleChanged=function(){g._button&&!g._hclStyle&&(g._button.style.backgroundColor=g._getColorFromMapStyle())},g._mapMoveStarted=function(){g._updateMapCamera=!1},g._mapMoveEnded=function(){g._updateMapCamera=g._options.updateMapCamera},g._onGpsSuccess=function(e){var o,t=g,a=t._options,n=t._map,i=t._lastKnownPosition,r=t._gpsMarker;if(e){o=[e.coords.longitude,e.coords.latitude];var s={timestamp:new Date(e.timestamp),_timestamp:e.timestamp};if(Object.assign(s,e.coords),a.calculateMissingValues&&i){if("number"!=typeof e.coords.speed){var l=e.timestamp-i.properties._timestamp,c=d.math.getDistanceTo(i.geometry.coordinates,o);s.speed=c/(.001*l)}"number"!=typeof e.coords.heading&&(s.heading=d.math.getHeading(i.geometry.coordinates,o))}i=new d.data.Feature(new d.data.Point(o),s),t._lastKnownPosition=i}if(i){if(o=o||i.geometry.coordinates,t._isActive){if(a.showUserLocation){if(r)r.setOptions({position:o,visible:t._isActive&&a.showUserLocation});else{var p=t._getMarkerIcon();t._gpsMarker=new d.HtmlMarker({position:o,htmlContent:p,anchor:"center"}),t._gpsMarker.marker.setPitchAlignment("map"),t._gpsMarker.marker.setRotationAlignment("map"),n.markers.add(t._gpsMarker)}t._updateMarkerHeading()}else r.setOptions({visible:!1});if(t._updateMapCamera){var u={center:o};n.getCamera().zoom<15&&(u.zoom=15),n.setCamera(u)}}t._invokeEvent("geolocationsuccess",i)}},g._onGpsError=function(e){var o=g;o._watchId=null,o._isActive=!1,o._updateState(),o._invokeEvent("geolocationerror",e)},e){var o=g._options;e.positionOptions&&(o.positionOptions=Object.assign(o.positionOptions,e.positionOptions)),e.style&&(o.style=e.style),e.markerColor&&(o.markerColor=e.markerColor),"boolean"==typeof e.showUserLocation&&(o.showUserLocation=e.showUserLocation),"boolean"==typeof e.trackUserLocation&&(o.trackUserLocation=e.trackUserLocation),"number"==typeof e.maxZoom&&(o.maxZoom=Math.min(Math.max(e.maxZoom,0),24)),"boolean"==typeof e.calculateMissingValues&&(o.calculateMissingValues=e.calculateMissingValues),"boolean"==typeof e.updateMapCamera&&(o.updateMapCamera=e.updateMapCamera,g._updateMapCamera=e.updateMapCamera)}return g}var m=Object.freeze({__proto__:null,GeolocationControl:p}),_=n.merge("atlas.control",m);e.control=_}(this.atlas=this.atlas||{},atlas);
