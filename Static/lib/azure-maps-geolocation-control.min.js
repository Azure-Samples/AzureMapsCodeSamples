/* MIT License - Copyright (c) Microsoft Corporation. */


!function(o,m){"use strict";var e=function(o,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,t){o.__proto__=t}||function(o,t){for(var e in t)t.hasOwnProperty(e)&&(o[e]=t[e])})(o,t)};var r=function(){return(r=Object.assign||function(o){for(var t,e=1,a=arguments.length;e<a;e++)for(var n in t=arguments[e])Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n]);return o}).apply(this,arguments)};function t(o,r,s,l){return new(s=s||Promise)(function(e,t){function a(o){try{i(l.next(o))}catch(o){t(o)}}function n(o){try{i(l.throw(o))}catch(o){t(o)}}function i(o){var t;o.done?e(o.value):((t=o.value)instanceof s?t:new s(function(o){o(t)})).then(a,n)}i((l=l.apply(o,r||[])).next())})}function a(e,a){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function t(t){return function(o){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&t[0]?i.return:t[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,t[1])).done)return r;switch(i=0,r&&(t=[2&t[0],r.value]),t[0]){case 0:case 1:r=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,i=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(r=0<(r=s.trys).length&&r[r.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!r||t[1]>r[0]&&t[1]<r[3])){s.label=t[1];break}if(6===t[0]&&s.label<r[1]){s.label=r[1],r=t;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(t);break}r[2]&&s.ops.pop(),s.trys.pop();continue}t=a.call(e,s)}catch(o){t=[6,o],i=0}finally{n=r=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,o])}}}var n=(i.merge=function(o,t){for(var e=window||global,a=0,n=o.split(".");a<n.length;a++){var i=n[a];if(!e[i])return t;e=e[i]}return r(r({},e),t)},i);function i(){}var s,l,c,p=(s=m.internal.EventEmitter,e(l=g,c=s),l.prototype=null===c?Object.create(c):(u.prototype=c.prototype,new u),g.prototype.dispose=function(){var t=this;t._map&&t._map.controls.remove(t),Object.keys(t).forEach(function(o){t[o]=null})},g.prototype.getLastKnownPosition=function(){return JSON.parse(JSON.stringify(this._lastKnownPosition))},g.prototype.onAdd=function(o,t){var e=this,a=(e._map=o).getMapContainer().classList;a.contains("high-contrast-dark")?e._hclStyle="dark":a.contains("high-contrast-light")&&(e._hclStyle="light"),e._resource=e._getTranslations(e._map.getStyle().language);var n=g,i=n._iconTemplate.replace("{color}","Gray"),r=n._iconTemplate.replace("{color}","DeepSkyBlue"),s=n._gpsBtnCss.replace(/{grayIcon}/g,i).replace(/{blueIcon}/g,r),l=document.createElement("style");l.innerHTML=s,document.body.appendChild(l);var c=document.createElement("div");c.classList.add("azure-maps-control-container"),c.setAttribute("aria-label",e._resource[0]),c.style.flexDirection="column",c.style.display="none",e._container=c;var p=document.createElement("button");return p.classList.add("azmaps-gpsBtn"),p.classList.add("azmaps-gpsDisabled"),p.setAttribute("title",e._resource[0]),p.setAttribute("alt",e._resource[0]),p.setAttribute("type","button"),p.addEventListener("click",e._toggleBtn),e._button=p,e._updateState(),e.setOptions(e._options),c.appendChild(p),n.isSupported().then(function(o){o?e._container.style.display="":e._invokeEvent("geolocationerror",{code:2,message:"Geolocation API not supported by device.",PERMISSION_DENIED:1,POSITION_UNAVAILABLE:2,TIMEOUT:3})}),e._map.events.add("movestart",e._mapMoveStarted),e.setOptions(e._options),c},g.prototype.onRemove=function(){var o=this;o._container&&o._container.remove(),"auto"===o._options.style&&o._map.events.remove("styledata",o._mapStyleChanged),o._map.events.remove("movestart",o._mapMoveStarted),void 0!==o._watchId&&navigator.geolocation.clearWatch(o._watchId),o._gpsMarker&&o._map.markers.remove(o._gpsMarker),o._map=null},g.prototype.getOptions=function(){return Object.assign({},this._options)},g.prototype.setOptions=function(o){var t=this,e=t._options;if(o){var a="white";if(t._hclStyle)"dark"===t._hclStyle&&(a=t._darkColor);else switch("auto"===e.style&&t._map.events.remove("styledata",t._mapStyleChanged),e.style=o.style,o.style){case"dark":a=t._darkColor;break;case"auto":t._map.events.add("styledata",t._mapStyleChanged),a=t._getColorFromMapStyle()}if(t._button.style.backgroundColor=a,o.markerColor&&(e.markerColor=o.markerColor,t._gpsMarker&&t._gpsMarker.setOptions({color:o.markerColor})),"number"==typeof o.maxZoom&&(e.maxZoom=Math.min(Math.max(o.maxZoom,0),24)),"boolean"==typeof o.calculateMissingValues&&(e.calculateMissingValues=o.calculateMissingValues),"boolean"==typeof o.updateMapCamera&&(e.updateMapCamera=o.updateMapCamera,t._updateMapCamera=o.updateMapCamera),"boolean"==typeof o.showUserLocation&&(e.showUserLocation=o.showUserLocation,t._gpsMarker?t._gpsMarker.setOptions({visible:t._isActive&&o.showUserLocation}):t._lastKnownPosition&&t._onGpsSuccess()),"boolean"==typeof o.trackUserLocation&&(e.trackUserLocation=o.trackUserLocation),o.positionOptions){var n={};o.positionOptions.enableHighAccuracy&&(n.enableHighAccuracy=o.positionOptions.enableHighAccuracy),"number"==typeof o.positionOptions.maximumAge&&(n.maximumAge=o.positionOptions.maximumAge),"number"==typeof o.positionOptions.timeout&&(n.timeout=o.positionOptions.timeout),0<Object.keys(n).length&&(e.positionOptions=Object.assign(e.positionOptions,n),t._stopTracking(),t._updateState())}}},g.prototype.toggle=function(o){var t=this;t._isActive="boolean"==typeof o?o:!t._isActive,t._isActive&&t._options.trackUserLocation&&t._lastKnownPosition&&t._onGpsSuccess(),t._updateMapCamera=t._options.updateMapCamera,t._updateState()},g.isSupported=function(){return t(this,void 0,void 0,function(){return a(this,function(o){switch(o.label){case 0:return window.navigator.permissions?[4,window.navigator.permissions.query({name:"geolocation"})]:[3,2];case 1:return[2,"denied"!==o.sent().state];case 2:return[2,!!window.navigator.geolocation]}})})},g.prototype._getColorFromMapStyle=function(){return-1<["satellite","satellite_road_labels","grayscale_dark","night"].indexOf(this._map.getStyle().style)?this._darkColor:"white"},g.prototype._stopTracking=function(){"number"==typeof this._watchId&&(navigator.geolocation.clearWatch(this._watchId),this._watchId=null)},g.prototype._updateState=function(){var o=this;o._isActive&&!o._options.trackUserLocation||o._stopTracking(),o._gpsMarker&&o._gpsMarker.setOptions({visible:o._isActive&&o._options.showUserLocation});var t=o._resource[2],e="azmaps-gpsEnabled",a="azmaps-gpsDisabled";o._isActive?(e="azmaps-gpsDisabled",a="azmaps-gpsEnabled",o._options.trackUserLocation?("number"!=typeof o._watchId&&(o._watchId=navigator.geolocation.watchPosition(o._onGpsSuccess,o._onGpsError,o._options.positionOptions)),t=o._resource[1]):navigator.geolocation.getCurrentPosition(o._onGpsSuccess,o._onGpsError,o._options.positionOptions)):o._options.trackUserLocation&&(t=o._resource[0]);var n=o._button;n.setAttribute("title",t),n.setAttribute("alt",t),n.classList.remove(e),n.classList.add(a)},g.prototype._getMarkerIcon=function(){var o=g._gpsDotIcon,t=this._lastKnownPosition.properties.heading;if(this._options.trackUserLocation&&null!==t&&!isNaN(t)){var e="-webkit-transform:rotate("+(t=Math.round(t))+"deg);transform:rotate("+t+"deg)";o=g._gpsArrowIcon.replace("{transform}",e)}return o},g.prototype._getTranslations=function(o){o&&0<o.indexOf("-")&&(o=o.substring(0,o.indexOf("-")));var t=g._translations,e=t[o];return e=e||t.en},g._gpsArrowIcon='<div style="{transform}"><svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 28 28"><g transform="translate(2 2)"><polygon points="12,0 0,24 12,17 24,24" stroke-width="2" stroke="white" fill="{color}"/></g></svg></div>',g._gpsDotIcon='<div class="azmaps-gpsPulseIcon" style="background-color:{color}"></div>',g._iconTemplate="data:image/svg+xml;utf8,<svg version='1.1' xmlns='http://www.w3.org/2000/svg' x='0' y='0' viewBox='0 0 561 561' xml:space='preserve'><g fill='{color}'><path d='M280.5,178.5c-56.1,0-102,45.9-102,102c0,56.1,45.9,102,102,102c56.1,0,102-45.9,102-102C382.5,224.4,336.6,178.5,280.5,178.5z M507.45,255C494.7,147.9,410.55,63.75,306,53.55V0h-51v53.55C147.9,63.75,63.75,147.9,53.55,255H0v51h53.55C66.3,413.1,150.45,497.25,255,507.45V561h51v-53.55C413.1,494.7,497.25,410.55,507.45,306H561v-51H507.45z M280.5,459C181.05,459,102,379.95,102,280.5S181.05,102,280.5,102S459,181.05,459,280.5S379.95,459,280.5,459z'/></g></svg>",g._gpsBtnCss='.azmaps-gpsBtn{margin:0;padding:0;border:none;border-collapse:collapse;width:32px;height:32px;text-align:center;cursor:pointer;line-height:32px;background-repeat:no-repeat;background-size:20px;background-position:center center;z-index:200;box-shadow:0px 0px 4px rgba(0,0,0,0.16);}.azmaps-gpsDisabled{background-image:url("{grayIcon}");}.azmaps-gpsDisabled:hover{background-image:url("{blueIcon}");filter:brightness(90%);}.azmaps-gpsEnabled{background-image:url("{blueIcon}");}.azmaps-gpsEnabled:hover{background-image:url("{blueIcon}");filter:brightness(90%);}.azmaps-gpsPulseIcon{display:block;width:15px;height:15px;border-radius:50%;background:orange;border:2px solid white;cursor:pointer;box-shadow:0 0 0 rgba(0, 204, 255, 0.6);animation:pulse 2s infinite;}@keyframes pulse {0% {box-shadow:0 0 0 0 rgba(0, 204, 255, 0.6);}70% {box-shadow:0 0 0 20px rgba(0, 204, 255, 0);}100% {box-shadow:0 0 0 0 rgba(0, 204, 255, 0);}}',g._translations={af:["begin dop","stop die dop","my plek","ligginggewing beheer"],ar:["بدء تتبع","تتبع توقف","موقعي","السيطرة تحديد الموقع الجغرافي"],eu:["Hasi segimendua","Stop jarraipena","Nire kokapena","Geokokapen kontrol"],bg:["Започнете да проследявате","Спиране на проследяването","Моето място","контрол за геолокация"],zh:["开始跟踪","停止追踪","我的位置","地理位置控制"],hr:["Započnite praćenje","zaustavljanje praćenje","Moja lokacija","kontrola Geolocation"],cs:["začít sledovat","Zastavit sledování","Moje lokace","ovládání Geolocation"],da:["Start sporing","Stop sporing","min placering","Geolocation kontrol"],nl:["beginnen met het bijhouden","stop volgen","Mijn locatie","Geolocation controle"],et:["Alusta jälgimist","Stopp jälgimise","Minu asukoht","Geolocation kontrolli"],fi:["Aloita seuranta","Lopeta seuranta","Minun sijaintini","Geolocation ohjaus"],fr:["Démarrer le suivi","suivi d'arrêt","Ma position","le contrôle de géolocalisation"],gl:["comezar a controlar","seguimento parada","A miña localización","control de xeolocalización"],de:["starten Sie Tracking","Stop-Tracking","Mein Standort","Geolokalisierung Steuer"],el:["Ξεκινήστε την παρακολούθηση","Διακοπή παρακολούθησης","Η τοποθεσία μου","ελέγχου geolocation"],hi:["ट्रैक करना शुरू","बंद करो ट्रैकिंग","मेरा स्थान","जियोलोकेशन नियंत्रण"],hu:["követés indítása","követés leállítása","Saját hely","Geolocation ellenőrzés"],id:["Mulai pelacakan","berhenti pelacakan","Lokasi saya","kontrol geolocation"],it:["Inizia il monitoraggio","monitoraggio arresto","La mia posizione","controllo geolocalizzazione"],ja:["追跡を開始","追跡を停止","私の場所","ジオロケーション制御"],kk:["қадағалау бастау","қадағалау тоқтату","Менің орналасуы","геоорын бақылау"],ko:["추적 시작","정지 추적","내 위치","위치 정보 제어"],es:["iniciar el seguimiento","Detener el seguimiento","Mi ubicacion","control de geolocalización"],lv:["Sākt izsekošana","Stop izsekošana","Mana atrašanās vieta","Geolocation kontrole"],lt:["pradėti stebėti","Sustabdyti sekimo","Mano vieta","Geografinė padėtis kontrolė"],ms:["mula menjejaki","Stop pengesanan","Lokasi saya","kawalan geolokasi"],nb:["begynne å spore","stopp sporing","Min posisjon","geolocation kontroll"],pl:["rozpocząć śledzenie","Zatrzymaj śledzenie","Moja lokacja","kontrola Geolokalizacja"],pt:["começar a controlar","rastreamento parada","Minha localização","controle de geolocalização"],ro:["Pornire urmărire","Oprire urmărire","Locatia mea","controlul de geolocalizare"],ru:["Начать отслеживание","остановка отслеживания","Мое местонахождение","контроль геолокации"],sr:["Старт трацкинг","стоп праћење","Моја локација","kontrola геолоцатион"],sk:["začať sledovať","zastaviť sledovanie","moja poloha","ovládanie Geolocation"],sl:["Začni sledenje","Stop za sledenje","moja lokacija","nadzor Geolocation"],sv:["börja spåra","Stoppa spårning","Min plats","geolocation kontroll"],th:["เริ่มการติดตาม","ติดตามหยุด","ตำแหน่งของฉัน","ควบคุม Geolocation"],tr:["izlemeyi başlat","Dur izleme","Benim konumum","Coğrafi Konum kontrolü"],uk:["почати відстеження","зупинка відстеження","моє місце розташування","контроль геолокації"],vi:["Bắt đầu theo dõi","dừng theo dõi","vị trí của tôi","kiểm soát định vị"],en:["Start tracking","Stop tracking","My location","Geolocation control"]},g);function u(){this.constructor=l}function g(o){var g=s.call(this)||this;if(g._options={style:"light",positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},showUserLocation:!0,trackUserLocation:!1,markerColor:"DodgerBlue",maxZoom:15,calculateMissingValues:!1,updateMapCamera:!0},g._darkColor="#011c2c",g._hclStyle=null,g._isActive=!1,g._updateMapCamera=!0,g._toggleBtn=function(){g.toggle()},g._mapStyleChanged=function(){g._button&&!g._hclStyle&&(g._button.style.backgroundColor=g._getColorFromMapStyle())},g._mapMoveStarted=function(){g._updateMapCamera=!1},g._onGpsSuccess=function(o){var t,e=g,a=e._options,n=e._map,i=e._lastKnownPosition,r=e._gpsMarker;if(o){t=[o.coords.longitude,o.coords.latitude];var s={timestamp:new Date(o.timestamp),_timestamp:o.timestamp};if(Object.assign(s,o.coords),a.calculateMissingValues&&i){if("number"!=typeof o.coords.speed){var l=o.timestamp-i.properties._timestamp,c=m.math.getDistanceTo(i.geometry.coordinates,t);s.speed=c/(.001*l)}"number"!=typeof o.coords.heading&&(s.heading=m.math.getHeading(i.geometry.coordinates,t))}i=new m.data.Feature(new m.data.Point(t),s),e._lastKnownPosition=i}if(i){if(t=t||i.geometry.coordinates,e._isActive){var p=e._getMarkerIcon();if(a.showUserLocation?r?r.setOptions({position:t,htmlContent:p,visible:e._isActive&&a.showUserLocation}):(e._gpsMarker=new m.HtmlMarker({position:t,htmlContent:p,color:a.markerColor}),n.markers.add(e._gpsMarker)):r.setOptions({visible:!1}),e._updateMapCamera){var u={center:t};n.getCamera().zoom<15&&(u.zoom=15),n.setCamera(u)}}e._invokeEvent("geolocationsuccess",i)}},g._onGpsError=function(o){var t=g;t._watchId=null,t._isActive=!1,t._updateState(),t._invokeEvent("geolocationerror",o)},o){var t=g._options;o.positionOptions&&(t.positionOptions=Object.assign(t.positionOptions,o.positionOptions)),o.style&&(t.style=o.style),o.markerColor&&(t.markerColor=o.markerColor),"boolean"==typeof o.showUserLocation&&(t.showUserLocation=o.showUserLocation),"boolean"==typeof o.trackUserLocation&&(t.trackUserLocation=o.trackUserLocation),"number"==typeof o.maxZoom&&(t.maxZoom=Math.min(Math.max(o.maxZoom,0),24)),"boolean"==typeof o.calculateMissingValues&&(t.calculateMissingValues=o.calculateMissingValues),"boolean"==typeof o.updateMapCamera&&(t.updateMapCamera=o.updateMapCamera,g._updateMapCamera=o.updateMapCamera)}return g}var d=Object.freeze({__proto__:null,GeolocationControl:p}),_=n.merge("atlas.control",d);o.control=_}(this.atlas=this.atlas||{},atlas);
