<!DOCTYPE html>
<html>
<head>
    <title>Azure Maps Web Control Samples - Layer Events</title>

    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta name="description" content="This sample highlights the name of the events that are firing as you interact with the Symbol Layer. The Symbol, Bubble, Line and Polygon layer all support the same set of events. The Tile Layer does not support any of these events." />
    <meta name="keywords" content="map, gis, API, SDK, events, bubbble, circles, bubblelayer, line, linestring, polyline, polygon, symbols, markers, pins, pushpins, layer, click, mouse, touch, context menu, wheel" />
    <meta name="author" content="Microsoft Azure Maps" />
    <link href="/SiteResources/azure-maps-logo-13.png" rel="shortcut icon" />

    <!-- Add references to the Azure Maps Map control JavaScript and CSS files. -->
    <link rel="stylesheet" href="https://atlas.microsoft.com/sdk/css/atlas.min.css?api-version=1" type="text/css" />
    <script src="https://atlas.microsoft.com/sdk/js/atlas.min.js?api-version=1"></script>

    <script type='text/javascript'>
        var map, testDataSize = 100,
            symbolLayerEvents = ['mousedown', 'mouseup', 'mouseover', 'mousemove', 'click', 'dblclick', 'mouseout', 'mouseenter', 'mouseleave', 'contextmenu', 'touchstart', 'touchend', 'touchmove', 'touchcancel', 'wheel'];

        function GetMap() {
            //Add your Azure Maps subscription key to the map SDK. Get an Azure Maps key at https://azure.com/maps
            atlas.setSubscriptionKey('<Your Azure Maps Key>');

            //Initialize a map instance.
            map = new atlas.Map('myMap');

            //Wait until the map resources have fully loaded.
            map.events.add('load', function (e) {
                //Create a data source and add it to the map.
                var datasource = new atlas.source.DataSource();
                map.sources.add(datasource);

                //Add random point features to data source.
                datasource.add(generateRandomPoints(testDataSize));

                //Create a layer to render the point data.
                var symbolLayer = new atlas.layer.SymbolLayer(datasource);
                map.layers.add(symbolLayer);

                //Add the events to the symbol layer.
                for (var i = 0; i < symbolLayerEvents.length; i++) {
                    map.events.add(symbolLayerEvents[i], symbolLayer, highlight);

                    //Add a div to highlight the event.
                    document.getElementById('eventPanel').innerHTML += '<div id="' + symbolLayerEvents[i] + '">' + symbolLayerEvents[i] + '</div>'
                }
            });
        }

        function highlight(e) {
            //Highlight the div to indicate that the event has fired.
            document.getElementById(e.type).style.background = 'LightGreen';

            //Remove the highlighting after a second.
            setTimeout(function () { document.getElementById(e.type).style.background = 'white'; }, 1000);
        }

        function generateRandomPoints(cnt) {
            var layerData = [];

            for (var i = 0; i < cnt; i++) {
                layerData.push(new atlas.data.Feature(new atlas.data.Point([Math.random() * 360 - 180, Math.random() * 170 - 85]), {
                    title: 'Pin_' + i
                }));
            }

            return layerData;
        }

    </script>
</head>
<body onload="GetMap()">
    <div id="myMap" style="position:relative;width:100%;min-width:350px;height:600px;"></div>

    <div id="eventPanel" style="position:absolute;top:0;left:0;background-color:white;padding:10px;"></div>

    <fieldset style="width:calc(100% - 30px);min-width:350px;margin-top:10px;">
        <legend>Layer Event</legend>
        This sample highlights the name of the events that are firing as you interact with the Symbol Layer. 
        The Symbol, Bubble, Line and Polygon layer all support the same set of events. 
        The Tile Layer does not support any of these events.
    </fieldset>
</body>
</html>